<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,
    minimum-scale=1,maximum-scale=1.0,minimal-ui">
    <!--The following two meta tags will be helpful in the "add to home screen" function in ios safari.
    It will make the page more native-->
    <meta name="apple-touch-fullscreen" content="YES" />
    <!--<meta name="apple-mobile-web-app-capable" content="yes" />-->
    <meta name="apple-mobile-web-app-status-bar-style" content="white" />
    <title>Whack-mole-holes-Vue.js</title>
    <script src="js/vue.js"></script>
    <style>
        * {
            padding: 0;
            border: none;
            margin:0;
        }
        html {
            height: 100%;
            /*A hack used to let 100% height valid.*/
        }
        body {
            height: 95%;
            /*A hack used to let 100% height valid.*/
            -moz-user-select:none;
            font-size: 16px;
            margin: 2.5%;
        }
        .clearfix {zoom:1;}
        .clearfix:before,.clearfix:after {
            content: ' ';
            display: table;
        }
        .clearfix:after { clear: both;}

        .app {
            width:95%;
            height: 95%;
            padding: 2.5%;
            outline: 1px solid red;
            margin: 0 auto;
            position: relative;
        }
        .target {
            float: left;
            width:20%;
            height:200px;
            margin: 2.5%;
        }
        .hole {
            background-color: black;
        }
        .mole-hole {
            background-color: green;
        }
        .rabbit-hole {
            background-color: yellow;
        }
        .control-panel {
            width:95%;
            padding: 1% 2.5%;
            position: absolute;
            left:0;
            bottom: 0;
        }
        .control-panel table {
            width: 100%;
        }
        .control-panel table td {
            width:25%;
            text-align: center;
        }
        .final-score-table-data {
            width:50%;
        }
        .final-score {
            text-align: center;
        }
        .addingScore {
            /*display: none;*/
            position: absolute;
            top: -100%;
            left: 40%;
            opacity:1;
            animation: addScore 1.3s linear infinite;
        }
        .btn {
            width:60px;
            height:32px;
            border-radius: 4px;
        }
        .pause-btn {
            color: #fff;
            background-color: #337ab7;
            border-color: #2e6da4;
        }
        .pause-btn:active {
            background-color: #286090;
            border-color: #204d74;
        }
        .info-btn {
            color: #fff;
            background-color: #5bc0de;
            border-color: #46b8da;
        }
        .info-btn:active {
            background-color: #31b0d5;
            border-color: #269abc;
        }
        .info-panel {
            display: none;
        }

        @keyframes addScore {
           100% {
               top:-20%;
               left: 43%;
               opacity: 0;
               transform: scale(1.2);
           }
        }
    </style>
</head>
<body>
<div class="app">
    <div class="play-panel clearfix">
        <div class="target hole" @click.prevent="addScore()" v-for="n in holeNum"
         :data-holenum="n" :class="{rabbit:holesType[n-1]}">{{n}}</div>
        <!--<div class="target rabbit-hole" @click.prevent="deductScore()"></div>-->
    </div>
    <div class="control-panel clearfix">
        <table>
            <tbody>
                <tr>
                    <td>
                        <button class="btn pause-btn">Pause</button>
                    </td>
                    <td class="final-score-table-data">
                        <h2 class="addingScore">+10</h2>
                        <!--<h2 class="deductingScore">-10</h2>-->
                        <h2 class="final-score">{{finalScore}}</h2>
                    </td>
                    <td>
                        <button class="btn info-btn">I</button>
                        <div class="info-panel">
                            Proudly made by juniortour.
                        </div>
                    </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    new Vue ({
        el:'.app',
        data:{
            holesType:[
                {0:false},
                {1:false},
                {2:true},
                {3:false},
                {4:true},
                {5:true},
                {6:false},
            ],
            finalScore:0,
            difficulty:'normal',
            holeNum:6,
            isRabbitHole:true
        },
        mounted:function () {
            this.$nextTick(function () {
                this.startGame();
            });
        },
        methods:{
            startGame: function () {
                /*开始游戏：
                * 1.初始化游戏：根据所选难度，渲染页面。
                * （难度主要区分在：出现的洞口数量多少，每轮动物出现的频率快慢）
                * 2.间隔随机生成地鼠和兔子，并相应的绑定点击事件
                *
                * 难点！！
                * 大致逻辑是：默认都是.hole的class，需要“随机”决定某些是.mole-hole或.rabbit-hole，
                * 并且！！！要相应的更新点击事件！！！
                *
                * 3.计算得分
                * 4.分享功能？
                * 5.随机事件、彩蛋：随机出现一只金地鼠，获得大量得分，但是消失的较快。*/
                switch (this.difficulty) {
                    case 'easy':
                        this.holeNum=4;
//                        this.freshRate=1
                        break;
                    case 'normal':
                        this.holeNum=6;
//                        this.freshRate=1
                        break;
                    case 'difficult':
                        this.holeNum=12;
//                        this.freshRate=1
                        break;
                }

//                let timer=setInterval(()=>{
//                    let randomInt=this.getRandomInt(1,6);
//                    console.log('randomInt = '+randomInt);
//
//                    //stupid method
//                    let rabbitHoleHole=document.querySelector('div[data-holenum='+'"'+randomInt+'"'+']');
//                    rabbitHoleHole.classList+=' rabbit-hole';
//                },200)
            },
            addScore: function () {
                this.finalScore+=10;
            },
            deductScore: function () {
                this.finalScore-=10;
            },
            gamePause: function () {
                showOverlay();
                stopRandom();
            },
            getRandomInt: function (min,max) {
                min=Math.ceil(min); //向上取整
                max=Math.floor(max);    //向下取整
                return  Math.floor(Math.random()*(max-min+1)+min);
            }
        },
        computed: {
        }
    })
</script>
</body>
</html>